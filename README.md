# Form Concierge

Serverpod-powered Survey Form. Embeddable as a Widget in Flutter apps, along with Jaspr Web Form.

## Project Structure

| Directory | Description |
|-----------|-------------|
| `admin_dashboard/` | Flutter admin dashboard |
| `server/` | Serverpod backend server |
| `widget/` | Flutter widget for embedding surveys |
| `web/` | Jaspr web survey form |
| `examples/` | Example apps demonstrating `widget/` usage |
| `client/` | Serverpod client package (auto-generated by `serverpod generate`) |

## Local Development

### Prerequisites

- Dart SDK ^3.6.0
- Docker
- Serverpod CLI: `dart pub global activate serverpod_cli`
- Jaspr CLI: `dart pub global activate jaspr_cli`

### Setup Order

1. **server/** - Start Docker, generate code, run server
   - See [server/README.md](server/README.md)

2. **web/** - Start Jaspr web app (requires server running)
   - See [web/README.md](web/README.md)

3. **admin_dashboard/** - Run Flutter admin app (requires server running)
   - See [admin_dashboard/README.md](admin_dashboard/README.md)

### Email Testing (MailHog)

1. Add the following to `server/config/passwords.yaml`:

   ```yaml
   development:
     smtpHost: 'localhost'
     smtpPort: '1025'
     smtpUsername: ''
     smtpPassword: ''
     smtpFromEmail: 'noreply@localhost'
     smtpFromName: 'Form Concierge'
   ```

2. Start MailHog:

   ```bash
   docker run -p 1025:1025 -p 8025:8025 mailhog/mailhog
   ```

3. View sent emails at http://localhost:8025

### Gemini API (Optional)

Adding a Gemini API key enables AI features:

- AI-generated survey question suggestions
- AI summary of survey responses

Add to `server/config/passwords.yaml`:

```yaml
development:
  geminiApiKey: 'your-api-key'
```

## Serverpod Cloud Deployment

### Prerequisites

Install the Serverpod Cloud CLI:

```bash
dart pub global activate serverpod_cloud_cli
```

### Login

```bash
scloud auth login
```

### Initial Deployment

For first-time deployment, run from the project root:

```bash
scloud launch
```

This interactive command will guide you through project setup and initial deployment.

### Subsequent Deployments

```bash
scloud deploy
```

Default Admin dashboard URL is `https://<project-name>.serverpod.space/admin`

### Environment Variables & Secrets

Set environment variables:

```bash
scloud variable create <name> <value>
scloud variable list
```

Set secrets (for sensitive values like API keys):

```bash
scloud secret create <name> <value>
scloud secret list
```

### Database Reset

To wipe and recreate the database (irreversible, deletes all data):

```bash
scloud db wipe
```

After wiping, redeploy to apply migrations on a fresh database:

```bash
scloud deploy
```
